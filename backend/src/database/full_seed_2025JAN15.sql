-- Auto-generated from THÁI MẬU OPERATION APP_2025JAN15.xlsx
-- Date: 2026-01-20T20:21:57.181Z

-- Table: app_modules
CREATE TABLE IF NOT EXISTS app_modules (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    module_id TEXT,
    module_name TEXT,
    page_name TEXT,
    active BOOLEAN DEFAULT TRUE,
    role_access TEXT,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Sync Columns
ALTER TABLE app_modules ADD COLUMN IF NOT EXISTS module_id TEXT;
ALTER TABLE app_modules ADD COLUMN IF NOT EXISTS module_name TEXT;
ALTER TABLE app_modules ADD COLUMN IF NOT EXISTS page_name TEXT;
ALTER TABLE app_modules ADD COLUMN IF NOT EXISTS active BOOLEAN DEFAULT TRUE;
ALTER TABLE app_modules ADD COLUMN IF NOT EXISTS role_access TEXT;
ALTER TABLE app_modules ADD COLUMN IF NOT EXISTS created_at TIMESTAMPTZ DEFAULT NOW();
ALTER TABLE app_modules ADD COLUMN IF NOT EXISTS updated_at TIMESTAMPTZ DEFAULT NOW();

INSERT INTO app_modules (module_id, module_name, page_name, active, role_access) VALUES
('shiftlog', 'Báo Cáo Ca', 'Page_ShiftLog', TRUE, 'STAFF,LEADER,CEO'),
('inventory', 'Kiểm Kho', 'Page_Inventory', FALSE, 'LEADER,CEO'),
('reports', 'Dashboard', 'Page_Dashboardfalse', FALSE, 'CEO')
ON CONFLICT DO NOTHING;

-- Table: tenants
CREATE TABLE IF NOT EXISTS tenants (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    tenant_id TEXT,
    tenant_name TEXT,
    status TEXT,
    created_at TIMESTAMPTZ,
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Sync Columns
ALTER TABLE tenants ADD COLUMN IF NOT EXISTS tenant_id TEXT;
ALTER TABLE tenants ADD COLUMN IF NOT EXISTS tenant_name TEXT;
ALTER TABLE tenants ADD COLUMN IF NOT EXISTS status TEXT;
ALTER TABLE tenants ADD COLUMN IF NOT EXISTS created_at TIMESTAMPTZ;
ALTER TABLE tenants ADD COLUMN IF NOT EXISTS updated_at TIMESTAMPTZ DEFAULT NOW();

INSERT INTO tenants (tenant_id, tenant_name, status, created_at) VALUES
('TMG_01', 'Thái Mậu Group - Main', 'active', '2026-01-15T15:04:29.821Z')
ON CONFLICT DO NOTHING;

-- Table: store_list
CREATE TABLE IF NOT EXISTS store_list (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    store_code TEXT,
    store_name TEXT,
    region TEXT,
    active BOOLEAN DEFAULT TRUE,
    brand_group_code TEXT,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Sync Columns
ALTER TABLE store_list ADD COLUMN IF NOT EXISTS store_code TEXT;
ALTER TABLE store_list ADD COLUMN IF NOT EXISTS store_name TEXT;
ALTER TABLE store_list ADD COLUMN IF NOT EXISTS region TEXT;
ALTER TABLE store_list ADD COLUMN IF NOT EXISTS active BOOLEAN DEFAULT TRUE;
ALTER TABLE store_list ADD COLUMN IF NOT EXISTS brand_group_code TEXT;
ALTER TABLE store_list ADD COLUMN IF NOT EXISTS created_at TIMESTAMPTZ DEFAULT NOW();
ALTER TABLE store_list ADD COLUMN IF NOT EXISTS updated_at TIMESTAMPTZ DEFAULT NOW();

INSERT INTO store_list (store_code, store_name, region, active, brand_group_code) VALUES
('DN-CLON', 'ĐN - Chợ Lớn', 'HCM', TRUE, 'DONG_NGUYEN'),
('DN-PMH', 'ĐN - Phú Mỹ Hưng', 'HCM', TRUE, 'DONG_NGUYEN'),
('DD-THISO', 'DD - THISO MALL', 'HCM', TRUE, 'DON DON'),
('DD-PMAL', 'DD- PARC MALL', 'HCM', TRUE, 'DONDON'),
('DH-CVL', 'Đông Hỷ - CVL', 'HCM', TRUE, 'DONG_HY'),
('GG-CVL', 'GET&GO CVL', 'HCM', TRUE, 'GET&GO'),
('TMG', 'THÁI MẬU', 'HCM', TRUE, 'HO')
ON CONFLICT DO NOTHING;

-- Table: role_master
CREATE TABLE IF NOT EXISTS role_master (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    role_code TEXT,
    role_name TEXT,
    level BIGINT,
    active BOOLEAN DEFAULT TRUE,
    note TEXT,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Sync Columns
ALTER TABLE role_master ADD COLUMN IF NOT EXISTS role_code TEXT;
ALTER TABLE role_master ADD COLUMN IF NOT EXISTS role_name TEXT;
ALTER TABLE role_master ADD COLUMN IF NOT EXISTS level BIGINT;
ALTER TABLE role_master ADD COLUMN IF NOT EXISTS active BOOLEAN DEFAULT TRUE;
ALTER TABLE role_master ADD COLUMN IF NOT EXISTS note TEXT;
ALTER TABLE role_master ADD COLUMN IF NOT EXISTS created_at TIMESTAMPTZ DEFAULT NOW();
ALTER TABLE role_master ADD COLUMN IF NOT EXISTS updated_at TIMESTAMPTZ DEFAULT NOW();

INSERT INTO role_master (role_code, role_name, level, active, note) VALUES
('ADMIN', 'Administrator', 100, TRUE, 'Toàn quyền hệ thống'),
('BOD', 'Board of Director', 90, TRUE, 'Ban điều hành'),
('OPS', 'Operations', 80, TRUE, 'Vận hành hệ thống'),
('SM', 'Store Manager', 60, TRUE, 'Quản lý cửa hàng'),
('LEADER', 'Crew Leader', 30, TRUE, 'Trưởng ca'),
('STAFF', 'Staff', 10, TRUE, 'Nhân viên')
ON CONFLICT DO NOTHING;

-- Table: staff_master
CREATE TABLE IF NOT EXISTS staff_master (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    staff_id TEXT,
    staff_name TEXT,
    email TEXT,
    password_hash TEXT,
    role TEXT,
    store_code TEXT,
    active BOOLEAN DEFAULT TRUE,
    tenant_id TEXT,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Sync Columns
ALTER TABLE staff_master ADD COLUMN IF NOT EXISTS staff_id TEXT;
ALTER TABLE staff_master ADD COLUMN IF NOT EXISTS staff_name TEXT;
ALTER TABLE staff_master ADD COLUMN IF NOT EXISTS email TEXT;
ALTER TABLE staff_master ADD COLUMN IF NOT EXISTS password_hash TEXT;
ALTER TABLE staff_master ADD COLUMN IF NOT EXISTS role TEXT;
ALTER TABLE staff_master ADD COLUMN IF NOT EXISTS store_code TEXT;
ALTER TABLE staff_master ADD COLUMN IF NOT EXISTS active BOOLEAN DEFAULT TRUE;
ALTER TABLE staff_master ADD COLUMN IF NOT EXISTS tenant_id TEXT;
ALTER TABLE staff_master ADD COLUMN IF NOT EXISTS created_at TIMESTAMPTZ DEFAULT NOW();
ALTER TABLE staff_master ADD COLUMN IF NOT EXISTS updated_at TIMESTAMPTZ DEFAULT NOW();

INSERT INTO staff_master (staff_id, staff_name, email, password_hash, role, store_code, active, tenant_id) VALUES
('NV001', 'Nguyễn Văn A', NULL, NULL, 'STAFF', 'DN-PMH', TRUE, NULL),
('NV002', 'Trần Thị B', NULL, NULL, 'STAFF', 'DN-PMH', TRUE, NULL),
('NV003', 'Lê Văn C', NULL, NULL, 'LEADER', 'DN-PMH', TRUE, NULL),
('NV004', 'Phạm Minh D', NULL, NULL, 'LEADER', 'DD-THSO', TRUE, NULL),
('NV005', 'Hoàng Anh E', NULL, NULL, 'STAFF', 'DD-THSO', TRUE, NULL),
('TM0001', 'Hưa Tấn Vinh', 'vinhhua77@gmail.com', 123456, 'ADMIN', 'DN-CLON', TRUE, NULL),
('TM0002', 'Hoàng Thuỵ Tường Vi', NULL, NULL, 'LEADER', 'DH-CVL', TRUE, NULL),
('TM1066', 'Ngô Hữu Hải', NULL, NULL, 'LEADER', 'TMG', TRUE, NULL),
('TEST01', 'OPS', NULL, NULL, 'STAFF', 'TMG', TRUE, NULL),
('TM1100', 'Trần Phương Thảo', 'tranphuongthao730@gmail.com', NULL, 'LEADER', 'DN-PMH', TRUE, NULL),
('TM0900', 'Nguyễn Hoàng Nhi', 'nhjnguyen23456@gmail.com', NULL, 'STAFF', 'DN-PMH', TRUE, NULL),
('TM1032', 'Huỳnh Thị Yến Nhi', 'huynhthiyennhi311@gmail.com', NULL, 'LEADER', 'DN-PMH', TRUE, NULL),
('TM1288', 'Lê Thị Ngân Huệ', 'le9672738@gamil.com', NULL, 'STAFF', 'DN-PMH', TRUE, NULL),
('TM1284', 'Đoàn Khánh Ngân', 'ngan.khanhdoanforwork@gmail.com', NULL, 'STAFF', 'DN-PMH', TRUE, NULL),
('TM1257', 'Trần Khải Đăng', 'boy2562007@gmail.com', NULL, 'STAFF', 'DN-PMH', TRUE, NULL),
('TM1178', 'Nguyễn Trần Minh Khôi', 'nguyentranminhkhoi06012008@gmail.com', NULL, 'STAFF', 'DN-PMH', TRUE, NULL),
('TM1274', 'Nguyễn Xuân Tùng', 'nxtung1712@gmail.com', NULL, 'STAFF', 'DN-PMH', TRUE, NULL),
('TM251234', 'Võ Tố Loan', 'ngocxinhlam66@gmail.com', NULL, 'STAFF', 'DN-PMH', TRUE, NULL),
('TM1269', 'Phạm Quốc Bình ', 'quocbinh918@gmail.com', NULL, 'STAFF', 'DN-PMH', TRUE, NULL),
('TM0718', 'Nguyễn Thị Kiều Linh', 'linhkieu632@gmail.com', NULL, 'LEADER', 'DN-PMH', TRUE, NULL),
('TM0010', 'HUA TAN VINH', NULL, NULL, 'STAFF', 'DN-CLON', TRUE, NULL),
('TM0003', 'vinh', 'vinhhua77@thaimau.vn', '$2a$10$.bYZy.x8T2kRJGkr8bTwk.5UBl9.QNOH9GGMasBHPCMzBSFKclgGy', 'STAFF', 'DN-CLON', TRUE, NULL),
('TM9999', 'Test User', 'test@thaimau.vn', '$2a$10$RIr6lX6VCaIBFz.ZFOr/Tu/eQzFZtAxlZfG2MIFYt8HxxubuN0KIS', 'STAFF', 'DD-THISO', TRUE, NULL)
ON CONFLICT DO NOTHING;

-- Table: ui_layout_config
CREATE TABLE IF NOT EXISTS ui_layout_config (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    layout_id TEXT,
    display_name TEXT,
    color_hex TEXT,
    icon_name TEXT,
    sort_order INTEGER,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Sync Columns
ALTER TABLE ui_layout_config ADD COLUMN IF NOT EXISTS layout_id TEXT;
ALTER TABLE ui_layout_config ADD COLUMN IF NOT EXISTS display_name TEXT;
ALTER TABLE ui_layout_config ADD COLUMN IF NOT EXISTS color_hex TEXT;
ALTER TABLE ui_layout_config ADD COLUMN IF NOT EXISTS icon_name TEXT;
ALTER TABLE ui_layout_config ADD COLUMN IF NOT EXISTS sort_order INTEGER;
ALTER TABLE ui_layout_config ADD COLUMN IF NOT EXISTS created_at TIMESTAMPTZ DEFAULT NOW();
ALTER TABLE ui_layout_config ADD COLUMN IF NOT EXISTS updated_at TIMESTAMPTZ DEFAULT NOW();

INSERT INTO ui_layout_config (layout_id, display_name, color_hex, icon_name, sort_order) VALUES
('FOH', 'FOH', '#004AAD', 'users', 1),
('BOH', 'BOH', '#10B981', 'flame', 2),
('CASH', 'CASHIER', '#7C3AED', 'coins', 3),
('SUPPORT', 'HỖ TRỢ', NULL, NULL, 3)
ON CONFLICT DO NOTHING;

-- Table: sub_position_master
CREATE TABLE IF NOT EXISTS sub_position_master (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    sub_id TEXT,
    sub_position TEXT,
    layout TEXT,
    is_default BOOLEAN,
    active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Sync Columns
ALTER TABLE sub_position_master ADD COLUMN IF NOT EXISTS sub_id TEXT;
ALTER TABLE sub_position_master ADD COLUMN IF NOT EXISTS sub_position TEXT;
ALTER TABLE sub_position_master ADD COLUMN IF NOT EXISTS layout TEXT;
ALTER TABLE sub_position_master ADD COLUMN IF NOT EXISTS is_default BOOLEAN;
ALTER TABLE sub_position_master ADD COLUMN IF NOT EXISTS active BOOLEAN DEFAULT TRUE;
ALTER TABLE sub_position_master ADD COLUMN IF NOT EXISTS created_at TIMESTAMPTZ DEFAULT NOW();
ALTER TABLE sub_position_master ADD COLUMN IF NOT EXISTS updated_at TIMESTAMPTZ DEFAULT NOW();

INSERT INTO sub_position_master (sub_id, sub_position, layout, is_default, active) VALUES
('FOH_01', 'Order Chính', 'FOH', TRUE, TRUE),
('FOH_02', 'Order Thực Tập', 'FOH', TRUE, TRUE),
('FOH_03', 'CSKH / Hỗ trợ khách', 'FOH', TRUE, TRUE),
('FOH_04', 'Pha chế', 'FOH', TRUE, TRUE),
('LEAD_01', 'Lead ca ', 'LEAD', TRUE, TRUE),
('LEAD_02', 'Store Manager', 'LEAD', TRUE, TRUE),
('LEAD_03', 'Crew Leader', 'LEAD', TRUE, TRUE),
('LEAD_02', 'Staff 3', 'LEAD', TRUE, TRUE),
('BOH_01', 'Bếp Chảo', 'BOH', TRUE, TRUE),
('BOH_02', 'Quầy canh', 'BOH', FALSE, TRUE),
('BOH_03', 'Quầy mì', 'BOH', FALSE, TRUE),
('BOH_04', 'Quầy chặt', 'BOH', FALSE, TRUE),
('BOH_05', 'Điều phối KDS', 'BOH', FALSE, TRUE),
('BOH_06', 'Packing / Takeaway', 'BOH', TRUE, TRUE),
('CASH_01', 'Thu ngân chính', 'CASH', TRUE, TRUE),
('CASH_02', 'Thu ngân 3rd App', 'CASH', FALSE, TRUE),
('CASH_03', 'Thu ngân tập sự', 'CASH', FALSE, TRUE),
('SUP_01', 'Tiếp thực', 'SUPPORT', TRUE, TRUE),
('SUP_02', 'Rửa chén', 'SUPPORT', TRUE, TRUE),
('SUP_03', 'Bảo vệ', 'SUPPORT', FALSE, TRUE),
('SUP_04', 'Hỗ trợ linh hoạt', 'SUPPORT', FALSE, TRUE)
ON CONFLICT DO NOTHING;

-- Table: checklist_master
CREATE TABLE IF NOT EXISTS checklist_master (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    checklist_id TEXT,
    layout TEXT,
    checklist_text TEXT,
    sort_order INTEGER,
    is_required BOOLEAN,
    active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Sync Columns
ALTER TABLE checklist_master ADD COLUMN IF NOT EXISTS checklist_id TEXT;
ALTER TABLE checklist_master ADD COLUMN IF NOT EXISTS layout TEXT;
ALTER TABLE checklist_master ADD COLUMN IF NOT EXISTS checklist_text TEXT;
ALTER TABLE checklist_master ADD COLUMN IF NOT EXISTS sort_order INTEGER;
ALTER TABLE checklist_master ADD COLUMN IF NOT EXISTS is_required BOOLEAN;
ALTER TABLE checklist_master ADD COLUMN IF NOT EXISTS active BOOLEAN DEFAULT TRUE;
ALTER TABLE checklist_master ADD COLUMN IF NOT EXISTS created_at TIMESTAMPTZ DEFAULT NOW();
ALTER TABLE checklist_master ADD COLUMN IF NOT EXISTS updated_at TIMESTAMPTZ DEFAULT NOW();

INSERT INTO checklist_master (checklist_id, layout, checklist_text, sort_order, is_required, active) VALUES
('FOH_01', 'FOH', 'Phục vụ & giao tiếp khách - NQSCC', 1, TRUE, TRUE),
('FOH_06', 'FOH', 'POS/KDS hoạt động bình thường', 6, TRUE, TRUE),
('FOH_07', 'FOH', 'Không sai bill / thiếu món', 7, TRUE, TRUE),
('FOH_08', 'FOH', 'Phối hợp tốt với BOH', 8, TRUE, TRUE),
('FOH_099', 'FOH', 'Đã kiểm tra & bàn giao khu vực FOH cuối ca', 8, TRUE, TRUE),
('BOH_01', 'BOH', 'Định lượng & chất lượng đúng SOP', 1, TRUE, TRUE),
('BOH_02', 'BOH', 'Ra món đúng thứ tự / đúng thời gian', 2, TRUE, TRUE),
('BOH_03', 'BOH', 'Phối hợp trong bếp tốt', 3, TRUE, TRUE),
('BOH_04', 'BOH', 'Bếp sạch - An Toàn VSTP -ATLD', 4, TRUE, TRUE),
('BOH_99 ', 'BOH', 'Đã kiểm tra & bàn giao khu vực BOH cuối ca', 4, TRUE, TRUE),
('CASH_01', 'CASH', 'POS hoạt động bình thường', 1, TRUE, TRUE),
('CASH_02', 'CASH', 'Không sai bill - Phục hồi', 2, TRUE, TRUE),
('CASH_03', 'CASH', 'Không lệch tiền', 3, TRUE, TRUE),
('CASH_99', 'CASH', 'Đã chốt tiền & bàn giao ca đầy đủ', 4, TRUE, TRUE),
('SUP_01', 'SUPPORT', 'Khu vực phụ trách gọn gàng - an toàn', 1, TRUE, TRUE),
('SUP_02', 'SUPPORT', 'Hỗ trợ kịp thời, không gây nghẽn vận hành', 2, TRUE, TRUE),
('SUP_05', 'SUPPORT', 'Khu vực phụ trách an toàn & bàn giao xong', 3, TRUE, TRUE),
('LEAD_01', 'LEAD', 'Ca vận hành đúng layout, không bỏ vị trí', 1, TRUE, TRUE),
('LEAD_02', 'LEAD', 'Nhân sự đủ lực, phân công rõ ràng', 2, TRUE, TRUE),
('LEAD_03', 'LEAD', 'Các sự cố đã được xử lý hoặc ghi nhận đầy đủ', 3, TRUE, TRUE),
('LEAD_04', 'LEAD', 'Checklist nhân viên đã hoàn tất', 4, TRUE, TRUE),
('LEAD_05', 'LEAD', 'Ca đủ điều kiện bàn giao cho ca sau / SM', 5, TRUE, TRUE)
ON CONFLICT DO NOTHING;

-- Table: incident_master
CREATE TABLE IF NOT EXISTS incident_master (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    incident_id TEXT,
    layout TEXT,
    incident_name TEXT,
    active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Sync Columns
ALTER TABLE incident_master ADD COLUMN IF NOT EXISTS incident_id TEXT;
ALTER TABLE incident_master ADD COLUMN IF NOT EXISTS layout TEXT;
ALTER TABLE incident_master ADD COLUMN IF NOT EXISTS incident_name TEXT;
ALTER TABLE incident_master ADD COLUMN IF NOT EXISTS active BOOLEAN DEFAULT TRUE;
ALTER TABLE incident_master ADD COLUMN IF NOT EXISTS created_at TIMESTAMPTZ DEFAULT NOW();
ALTER TABLE incident_master ADD COLUMN IF NOT EXISTS updated_at TIMESTAMPTZ DEFAULT NOW();

INSERT INTO incident_master (incident_id, layout, incident_name, active) VALUES
('IC_FOH_01', 'FOH', 'Sai bill - Thiếu bill', TRUE),
('IC_FOH_02', 'FOH', 'Khách chờ lâu', TRUE),
('IC_FOH_03', 'FOH', 'Khách phàn nàn trực tiếp', TRUE),
('IC_FOH_04', 'FOH', 'Khách bỏ đi / hủy order', TRUE),
('IC_FOH_05', 'FOH', 'Khách căng thẳng / tranh cãi', TRUE),
('IC_FOH_06', 'FOH', 'Nhầm món / Hết món ', TRUE),
('IC_FOH_07', 'FOH', 'Sự cố WiFi – POS – thanh toán', TRUE),
('IC_BOH_01', 'BOH', 'Thiếu nguyên liệu - hết món', TRUE),
('IC_BOH_02', 'BOH', 'Thời gian ra món > 10''', TRUE),
('IC_BOH_03', 'BOH', 'Định lượng chưa chuẩn', TRUE),
('IC_BOH_04', 'BOH', 'Chất lượng món chưa đạt', TRUE),
('IC_BOH_05', 'BOH', 'Bếp phối hợp chưa tốt', TRUE),
('IC_BOH_06', 'BOH', 'Lỗi WI - Nghiệp Vụ Gói Takeaway', TRUE),
('IC_BOH_07', 'BOH', 'Thiết bị nhỏ trục trặc / thiếu dụng cụ', TRUE),
('IC_CASH_01', 'CASH', 'Sai tiền / sai bill / thiếu bill', TRUE),
('IC_CASH_02', 'CASH', 'Lỗi Hệ Thống - POS lỗi / treo , Payoo', TRUE),
('IC_CASH_03', 'CASH', 'Chốt ca bị lệch', TRUE),
('IC_CASH_04', 'CASH', 'Lỗi WI - Nghiệp vụ Thu Ngân', TRUE),
('IC_SUP_01', 'SUPPORT', 'Mất trật tự khu vực', TRUE),
('IC_SUP_02', 'SUPPORT', 'Cao điểm cần hỗ trợ', TRUE),
('IC_SUP_03', 'SUPPORT', 'Vệ sinh chưa đạt', TRUE),
('IC_SUP_04', 'SUPPORT', 'Sự cố an toàn - mất cắp', TRUE),
('IC_SUP_05', 'SUPPORT', 'Lên món chậm do hỗ trợ', TRUE),
('IC_SYS_01', 'ALL', 'Thiếu người / ca không đủ lực', TRUE),
('IC_SYS_02', 'ALL', 'Cao điểm quá tải', TRUE),
('IC_SYS_03', 'ALL', 'Sự cố hệ thống - thiết bị', TRUE),
('IC_SYS_04', 'ALL', 'Trải nghiệm khách hàng không tốt', TRUE),
('IC_SYS_05', 'ALL', 'Vi Phạm ATLĐ - ATVSTP ngiêm trọng', TRUE),
('IC_SYS_06', 'ALL', 'Không rõ quy trình / SOP', TRUE),
('IC_SYS_07', 'ALL', 'Mỗi người làm mỗi kiểu', TRUE),
('IC_SYS_08', 'ALL', 'Phối hợp giữa các vị trí chưa tốt', TRUE),
('IC_SYS_09', 'ALL', 'Bàn giao ca chưa rõ', TRUE),
('IC_LEAD_01 ', 'LEAD', ' Nhân sự / bố trí ca chưa ổn', TRUE),
('IC_LEAD_02', 'LEAD', 'Điều phối & kiểm soát cao điểm chưa tốt', TRUE),
('IC_LEAD_03', 'LEAD', 'Sự cố chưa xử lý trọn vẹn / chưa ghi nhận đầy đủ', TRUE)
ON CONFLICT DO NOTHING;

-- Table: shift_master
CREATE TABLE IF NOT EXISTS shift_master (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    shift_code TEXT,
    shift_name TEXT,
    start_hour TEXT,
    end_hour TEXT,
    active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Sync Columns
ALTER TABLE shift_master ADD COLUMN IF NOT EXISTS shift_code TEXT;
ALTER TABLE shift_master ADD COLUMN IF NOT EXISTS shift_name TEXT;
ALTER TABLE shift_master ADD COLUMN IF NOT EXISTS start_hour TEXT;
ALTER TABLE shift_master ALTER COLUMN start_hour TYPE TEXT USING start_hour::TEXT;
ALTER TABLE shift_master ADD COLUMN IF NOT EXISTS end_hour TEXT;
ALTER TABLE shift_master ALTER COLUMN end_hour TYPE TEXT USING end_hour::TEXT;
ALTER TABLE shift_master ADD COLUMN IF NOT EXISTS active BOOLEAN DEFAULT TRUE;
ALTER TABLE shift_master ADD COLUMN IF NOT EXISTS created_at TIMESTAMPTZ DEFAULT NOW();
ALTER TABLE shift_master ADD COLUMN IF NOT EXISTS updated_at TIMESTAMPTZ DEFAULT NOW();

INSERT INTO shift_master (shift_code, shift_name, start_hour, end_hour, active) VALUES
('S1_DD', 'S1_DD 08:00 - 16:00', '08:00', '16:00', TRUE),
('S2_DD', 'S2_DD 09:00 - 17:00', '09:00', '17:00', TRUE),
('S3_DD', 'S3_DD 10:00 - 18:00', '10:00', '18:00', TRUE),
('S4_DD', 'S4_DD 06:00 - 14:00', '06:00', '14:00', TRUE),
('C1_DD', 'C1_DD 11:00 - 19:00', '11:00', '19:00', TRUE),
('C2_DD', 'C2_DD 12:00 - 20:00', '12:00', '20:00', TRUE),
('C3_DD', 'C3_DD 13:00 - 21:00', '13:00', '21:00', TRUE),
('C4_DD', 'C4_DD 14:00 - 22:00', '14:00', '22:00', TRUE),
('G1', 'G1 07:00 - 12:00', '07:00', '12:00', TRUE),
('G2', 'G2 08:00 - 14:30', '08:00', '14:30', TRUE),
('G3', 'G3 07:30 - 14:30', '07:30', '14:30', TRUE),
('G4', 'G4 06:00 - 12:00', '06:00', '12:00', TRUE),
('P1', 'P1 07:00 - 12:00', '07:00', '12:00', TRUE),
('P2', 'P2 08:00 - 12:00', '08:00', '12:00', TRUE),
('P3', 'P3 08:00 - 13:00', '08:00', '13:00', TRUE),
('P4', 'P4 08:00 - 00:00', '08:00', '14:00', TRUE),
('P5', 'P5 08:00 - 00:00', '08:00', '15:00', TRUE),
('P6', 'P6 08:00 - 00:00', '08:00', '16:00', TRUE),
('P7', 'P7 09:00 - 00:00', '09:00', '14:00', TRUE),
('P8', 'P8 11:00 - 15:00', '11:00', '15:00', TRUE),
('P9', 'P9 13:00 - 21:00', '13:00', '21:00', TRUE),
('P10', 'P10 14:00 - 21:00', '14:00', '21:00', TRUE),
('P11', 'P11 15:00 - 21:00', '15:00', '21:00', TRUE),
('P12', 'P12 16:00 - 21:00', '16:00', '21:00', TRUE),
('P13', 'P13 17:00 - 21:00', '17:00', '21:00', TRUE),
('P14', 'P14 06:00 - 11:00', '06:00', '11:00', TRUE),
('P15', 'P15 06:00 - 12:00', '06:00', '12:00', TRUE),
('P16', 'P16 09:00 - 15:00', '09:00', '15:00', TRUE),
('P17', 'P17 15:00 - 22:00', '15:00', '22:00', TRUE),
('P18', 'P18 16:00 - 22:00', '16:00', '22:00', TRUE),
('P19', 'P19 17:00 - 22:00', '17:00', '22:00', TRUE),
('P20', 'P20 18:00 - 22:00', '18:00', '22:00', TRUE),
('OT1', 'OT1 16:00 - 18:00', '16:00', '18:00', TRUE),
('OT2', 'OT2 17:00 - 21:00', '17:00', '21:00', TRUE),
('OT3', 'OT3 18:00 - 21:00', '18:00', '21:00', TRUE),
('OT4', 'OT4 18:30 - 21:00', '18:30', '21:00', TRUE),
('OT5', 'OT5 19:00 - 21:00', '19:00', '21:00', TRUE),
('OT6', 'OT6 20:00 - 21:00', '20:00', '21:00', TRUE),
('OT7', 'OT7 21:00 - 21:30', '21:00', '21:30', TRUE),
('OT18', 'OT18 19:00 - 22:00', '19:00', '22:00', TRUE),
('OT19', 'OT19 20:00 - 22:00', '20:00', '22:00', TRUE),
('OT20', 'OT20 21:00 - 22:00', '21:00', '22:00', TRUE),
('G1', 'G1.1 07:00 - 20:00', '07:00', '12:00', TRUE),
('G1', 'G1.2 07:00 - 20:00', '17:00', '20:00', TRUE),
('G2', 'G2.1 08:00 - 18:30', '08:00', '14:30', TRUE),
('G2', 'G2.2 08:00 - 18:30', '17:00', '18:30', TRUE),
('G3', 'G3.1 07:30 - 17:00', '07:30', '14:30', TRUE),
('G3', 'G3.2 07:30 - 17:00', '16:00', '17:00', TRUE),
('G4', 'G4.1 06:00 - 19:00', '06:00', '12:00', TRUE),
('G4', 'G4.2 06:00 - 19:00', '17:00', '19:00', TRUE),
('BV_S', 'G4.2 06:00 - 19:00', '07:00', '16:00', TRUE)
ON CONFLICT DO NOTHING;

-- Table: md_observed_issue
CREATE TABLE IF NOT EXISTS md_observed_issue (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    code TEXT,
    name TEXT,
    active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Sync Columns
ALTER TABLE md_observed_issue ADD COLUMN IF NOT EXISTS code TEXT;
ALTER TABLE md_observed_issue ADD COLUMN IF NOT EXISTS name TEXT;
ALTER TABLE md_observed_issue ADD COLUMN IF NOT EXISTS active BOOLEAN DEFAULT TRUE;
ALTER TABLE md_observed_issue ADD COLUMN IF NOT EXISTS created_at TIMESTAMPTZ DEFAULT NOW();
ALTER TABLE md_observed_issue ADD COLUMN IF NOT EXISTS updated_at TIMESTAMPTZ DEFAULT NOW();

INSERT INTO md_observed_issue (code, name, active) VALUES
('OBS_PEAK_FLOW', 'Khách dồn giờ cao điểm (Rush hour)', TRUE),
('OBS_LAYOUT', 'Bố trí Layout gây chậm vận hành', TRUE),
('OBS_NEW_STAFF', 'Nhân viên mới chưa thuộc quy trình', TRUE),
('OBS_HYGIENE', 'Vệ sinh khu vực chưa đạt chuẩn', TRUE)
ON CONFLICT DO NOTHING;

-- Table: md_coaching_topic
CREATE TABLE IF NOT EXISTS md_coaching_topic (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    code TEXT,
    name TEXT,
    active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Sync Columns
ALTER TABLE md_coaching_topic ADD COLUMN IF NOT EXISTS code TEXT;
ALTER TABLE md_coaching_topic ADD COLUMN IF NOT EXISTS name TEXT;
ALTER TABLE md_coaching_topic ADD COLUMN IF NOT EXISTS active BOOLEAN DEFAULT TRUE;
ALTER TABLE md_coaching_topic ADD COLUMN IF NOT EXISTS created_at TIMESTAMPTZ DEFAULT NOW();
ALTER TABLE md_coaching_topic ADD COLUMN IF NOT EXISTS updated_at TIMESTAMPTZ DEFAULT NOW();

INSERT INTO md_coaching_topic (code, name, active) VALUES
('COACH_SERVICE', 'Kỹ năng phục vụ & Upsell', TRUE),
('COACH_SOP', 'Tuân thủ quy trình SOP', TRUE),
('COACH_SPEED', 'Tốc độ ra món (Ticket time)', TRUE)
ON CONFLICT DO NOTHING;

-- Table: md_next_shift_risk
CREATE TABLE IF NOT EXISTS md_next_shift_risk (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    code TEXT,
    name TEXT,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Sync Columns
ALTER TABLE md_next_shift_risk ADD COLUMN IF NOT EXISTS code TEXT;
ALTER TABLE md_next_shift_risk ADD COLUMN IF NOT EXISTS name TEXT;
ALTER TABLE md_next_shift_risk ADD COLUMN IF NOT EXISTS created_at TIMESTAMPTZ DEFAULT NOW();
ALTER TABLE md_next_shift_risk ADD COLUMN IF NOT EXISTS updated_at TIMESTAMPTZ DEFAULT NOW();

INSERT INTO md_next_shift_risk (code, name) VALUES
('NONE', 'Không có rủi ro'),
('LOW', 'Cần lưu ý nhẹ'),
('ATTENTION', 'Cần theo dõi sát ca sau')
ON CONFLICT DO NOTHING;

-- Table: announcements
CREATE TABLE IF NOT EXISTS announcements (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    record_id TEXT,
    content TEXT,
    start_date TIMESTAMPTZ,
    end_date TIMESTAMPTZ,
    active BOOLEAN DEFAULT TRUE,
    priority TEXT,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Sync Columns
ALTER TABLE announcements ADD COLUMN IF NOT EXISTS record_id TEXT;
ALTER TABLE announcements ADD COLUMN IF NOT EXISTS content TEXT;
ALTER TABLE announcements ADD COLUMN IF NOT EXISTS start_date TIMESTAMPTZ;
ALTER TABLE announcements ADD COLUMN IF NOT EXISTS end_date TIMESTAMPTZ;
ALTER TABLE announcements ADD COLUMN IF NOT EXISTS active BOOLEAN DEFAULT TRUE;
ALTER TABLE announcements ADD COLUMN IF NOT EXISTS priority TEXT;
ALTER TABLE announcements ADD COLUMN IF NOT EXISTS created_at TIMESTAMPTZ DEFAULT NOW();
ALTER TABLE announcements ADD COLUMN IF NOT EXISTS updated_at TIMESTAMPTZ DEFAULT NOW();

INSERT INTO announcements (record_id, content, start_date, end_date, active, priority) VALUES
('ANN_001', 'Yêu cầu kiểm tra kỹ vòi gas trước khi bàn giao ca!', '2026-01-04T07:18:34.888Z', '2026-12-30T16:59:30.000Z', TRUE, 'HIGH')
ON CONFLICT DO NOTHING;

